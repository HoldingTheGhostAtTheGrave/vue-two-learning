{"version":3,"file":"vue.js","sources":["../../src/observer/array.js","../../src/utils.js","../../src/observer/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["import { observer } from \"./index\";\r\n\r\n\r\n// 获取数组上的方法\r\nconst arrayProto = Array.prototype;\r\n\r\n// 继承该方法\r\nexport const arrayMethods = Object.create(arrayProto);\r\n\r\nconst methodsToPatch = [\r\n    'push',\r\n    'pop',\r\n    'shift',\r\n    'unshift',\r\n    'splice',\r\n    'sort',\r\n    'reverse'\r\n];\r\n\r\nmethodsToPatch.forEach((method) => {\r\n    // 新的方法\r\n    arrayMethods[method] = function (...args) {\r\n        // this 就是 observer里的value\r\n        let inserted;\r\n        let ob = this.__ob__;\r\n\r\n        if(method === 'push' || method === 'unshift'){\r\n            inserted = args;\r\n        }\r\n        if(method === 'splice'){\r\n            inserted = args.slice(2);\r\n        }\r\n        if(inserted){\r\n            ob.observerArray(inserted);\r\n        }\r\n        return arrayProto[method].apply(this,args);\r\n    }\r\n})                                        ","export function proxy (vm , data , key) {\r\n    Object.defineProperty(vm , key , {\r\n        get(){\r\n            return vm[data][key];\r\n        },\r\n        set(newValue){\r\n            if(vm[data][key] === newValue) return;\r\n            vm[data][key] = newValue;\r\n        }\r\n    });\r\n}\r\n\r\nexport function defineProperty (target,key,value){\r\n    // 判断一个对象是否被观测过 ， 判断是否存在 __ob__\r\n    Object.defineProperty(target,key,{\r\n        enumerable:false ,// 不可枚举的 循环获取不到这个属性\r\n        configurable:false, // 不能修改\r\n        value\r\n    });\r\n}","import { arrayMethods } from \"./array\";\r\nimport { defineProperty } from '../utils';\r\nclass Observer {\r\n    constructor(value){\r\n\r\n        // 设置 __ob__\r\n        defineProperty(value , '__ob__' , this);\r\n\r\n        // 使用defineProperty\r\n        if(Array.isArray(value)){\r\n            value.__proto__ = arrayMethods;\r\n            // 观测数组里的对象\r\n            this.observerArray(value);\r\n        }else{\r\n            this.walk(value);\r\n        }\r\n    }\r\n    walk(data){\r\n        let keys = Object.keys(data);\r\n        keys.forEach((key) => {\r\n            defineReactive(data , key , data[key]);\r\n        });\r\n    }\r\n    observerArray(value){\r\n        console.log(value,'valuevalue');\r\n        value.forEach((el) => {\r\n            observer(el);\r\n        });\r\n    }\r\n}\r\n\r\n// 数据劫持\r\nfunction defineReactive (data , key ,value) {\r\n    observer(value); // 判断当前的值如果为对象就再次进行递归\r\n    Object.defineProperty(data , key ,{\r\n        get(){\r\n            console.log('用户获取值');\r\n            return value\r\n        },\r\n        set(newValue){\r\n            console.log('用户设置值');\r\n            if(newValue === value) return ;\r\n            observer(newValue);  // 如果用户将值改为对象 继续监控\r\n            value = newValue;\r\n        }\r\n    });\r\n}\r\n\r\nexport function observer (data) {\r\n    if(typeof data !== 'object' || data === null){\r\n        return\r\n    }\r\n    if(data.__ob__){\r\n        return\r\n    }\r\n    return new Observer(data);\r\n}","import { observer } from \"./observer/index\";\r\nimport { proxy } from './utils';\r\n\r\nexport function initSatte (vm) {\r\n    const opts = vm.$options;\r\n    if(opts.props){\r\n        initProps(vm);\r\n    }\r\n    if(opts.methods){\r\n        initMethods(vm);\r\n    }\r\n    if(opts.data){\r\n        initData(vm);\r\n    }\r\n    if(opts.computed){\r\n        initComputed(vm);\r\n    }\r\n    if(opts.watch){\r\n        initWatch(vm);\r\n    }\r\n}\r\n\r\nfunction initData (vm) {\r\n    let data = vm.$options.data;\r\n    vm._data = data = typeof data === 'function' ? data.call(vm) : data;\r\n    // 数据的劫持方案\r\n    observer(data);\r\n\r\n    // 代理\r\n    for (const key in data) {\r\n        proxy(vm,'_data',key);\r\n    }\r\n}\r\n\r\nfunction initProps () {\r\n\r\n}\r\nfunction initMethods () {\r\n    \r\n}\r\n\r\nfunction initComputed () {\r\n    \r\n}\r\nfunction initWatch () {\r\n    \r\n}","import { initSatte } from \"./state\";\r\n\r\nexport function initMixin (Vue) {\r\n\r\n    //入口 初始化方法\r\n    Vue.prototype._init = function (options) {\r\n        const vm = this;\r\n        vm.$options = options;\r\n        \r\n        initSatte(vm); // 初始化状态\r\n\r\n        // vue 响应数据的变化 讲将数据作一个初始化的劫持 （数据改变时改变视图）\r\n    }\r\n}","import { initMixin } from './init';\r\n// 写 vue\r\n\r\n\r\n\r\n// 第一波 创建 vue 类 es5\r\nfunction Vue (options) {\r\n    this._init(options); //入口\r\n}\r\n\r\n\r\n// 写成一个个的插件 对 原型进行扩展\r\ninitMixin(Vue);\r\n\r\n\r\n\r\n\r\nexport default Vue;"],"names":["arrayProto","Array","prototype","arrayMethods","Object","create","methodsToPatch","forEach","method","inserted","ob","__ob__","args","slice","observerArray","apply","proxy","vm","data","key","defineProperty","get","set","newValue","target","value","enumerable","configurable","Observer","isArray","__proto__","walk","keys","defineReactive","console","log","el","observer","initSatte","opts","$options","props","methods","initData","computed","watch","_data","call","initMixin","Vue","_init","options"],"mappings":"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"}